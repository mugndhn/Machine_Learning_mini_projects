<!DOCTYPE html>

<head>
  <title>Line Charts</title>
  <meta charset="utf-8">
  <style type="text/css">

/* 13. Basic Styling with CSS */

/* Style the lines by removing the fill and applying a stroke */
.line {
    fill: none;
    stroke: #ffab00;
    stroke-width: 3;
}
  
.overlay {
  fill: none;
  pointer-events: all;
}

/* Style the dots by assigning a fill and stroke */
.dot {
    fill: #ffab00;
    stroke: #fff;
}
  
  .focus circle {
  fill: none;
  stroke: steelblue;
}

</style>
 <script type="text/javascript" src="../lib/d3.v5.min.js"></script>
  <script type="text/javascript" src="../lib/d3-dsv.min.js"></script>
</head>

<body>
  <div id='signature'>mmurugesan3</div>

    <svg width="960" height="500" id="svg-a"></svg>
    <svg width="960" height="500" id="svg-b"></svg>
    <svg width="960" height="500" id="svg-c-1"></svg>
    <svg width="960" height="500" id="svg-c-2"></svg>
  <script>

    // d3.select("#svg-a").append("text").text("Number of Ratings 2016-2020").style("font-size", "16px") .style("font-weight", "bold")  ;

//change1//////////////////////////////

var svg  = d3.select("#svg-a"),
    margin = {top: 50, right: 160, bottom: 50, left: 80},
    width = +svg.attr("width") - margin.left - margin.right,
    height = +svg.attr("height") - margin.top - margin.bottom;
    
var svg2  = d3.select("#svg-b"),
    margin1 = {top: 30, right: 10, bottom: 10, left: 100},
    width1 = +svg2.attr("width") - margin.left - margin.right,
    height1 = +svg2.attr("height") - margin.top - margin.bottom;

var svg3  = d3.select("#svg-c-1"),
    margin1 = {top: 30, right: 10, bottom: 10, left: 100},
    width1 = +svg3.attr("width") - margin.left - margin.right,
    height1 = +svg3.attr("height") - margin.top - margin.bottom;
    
var svg4 = d3.select("#svg-c-2"),
    margin1 = {top: 30, right: 10, bottom: 10, left: 100},
    width1 = +svg4.attr("width") - margin.left - margin.right,
    height1 = +svg4.attr("height") - margin.top - margin.bottom;


    //Title of the chart -a
    var title1 = d3.select("#svg-a")
    .append("text")
   // .attr("class", "chart title")
    .attr("x", ((width+margin.left+margin.right) / 2))             
    .attr("y", (margin.top / 2))
    .attr("text-anchor", "middle")  
    .style("font-size", "16px") 
    .style("font-weight", "bold")  
    .attr("id", "title-a")
    .text("Number of Ratings 2016-2020");
    
    var plot = svg.append("g").attr("id","plot-a")
    var la = plot.append("g").attr("id","lines-a").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    
    var xaxis = plot.append("g").attr("id","x-axis-a").attr("transform", "translate("+(margin.left)+"," + (height+margin.top) + ")")
    var yaxis = plot.append("g").attr("id","y-axis-a").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    
    
    var title2 = d3.select("#svg-b")
    .append("text")
   // .attr("class", "chart title")
    .attr("x", ((width+margin.left+margin.right) / 2))             
    .attr("y", (margin.top / 2))
    .attr("text-anchor", "middle")  
    .style("font-size", "16px") 
    .style("font-weight", "bold")  
    .attr("id", "title-b")
    .text("Number of Ratings 2016-2020");
    
    var plot2 = svg2.append("g").attr("id","plot-b")
    var la2 = plot2.append("g").attr("id","lines-b").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    
    //var labels = svg2.append("g").attr("id","lines-b").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var xaxis2 = plot2.append("g").attr("id","x-axis-b").attr("transform", "translate("+(margin.left)+"," + (height+margin.top) + ")")
    var yaxis2 = plot2.append("g").attr("id","y-axis-b").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var symb2 = plot2.append("g").attr("id","symbols-b").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var legend2 = svg2.append("g").attr("id","legend-b").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    
    var title3 = d3.select("#svg-c-1")
    .append("text")
   // .attr("class", "chart title")
    .attr("x", ((width+margin.left+margin.right) / 2))             
    .attr("y", (margin.top / 2))
    .attr("text-anchor", "middle")  
    .style("font-size", "16px") 
    .style("font-weight", "bold")  
    .attr("id", "title-c-1")
    .text("Number of Ratings 2016-2020");
    
    var plot3 = svg3.append("g").attr("id","plot-c-1")
    var la3 = plot3.append("g").attr("id","lines-c-1").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var xaxis3 = plot3.append("g").attr("id","x-axis-c-1").attr("transform", "translate("+(margin.left)+"," + (height+margin.top) + ")")
    var yaxis3 = plot3.append("g").attr("id","y-axis-c-1").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var symb3 = plot3.append("g").attr("id","symbols-c-1").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var legend3 = svg3.append("g").attr("id","legend-c-1").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    
    var title4 = d3.select("#svg-c-2")
    .append("text")
   // .attr("class", "chart title")
    .attr("x", ((width+margin.left+margin.right) / 2))             
    .attr("y", (margin.top / 2))
    .attr("text-anchor", "middle")  
    .style("font-size", "16px") 
    .style("font-weight", "bold")  
    .attr("id", "title-c-2")
    .text("Number of Ratings 2016-2020");
    
    var plot4 = svg4.append("g").attr("id","plot-c-2")
    var la4 = plot4.append("g").attr("id","lines-c-2").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var xaxis4 = plot4.append("g").attr("id","x-axis-c-2").attr("transform", "translate("+(margin.left)+"," + (height+margin.top) + ")")
    var yaxis4 = plot4.append("g").attr("id","y-axis-c-2").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var symb4 = plot4.append("g").attr("id","symbols-c-2").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    var legend4 = svg4.append("g").attr("id","legend-c-2").attr("transform", "translate("+(margin.left)+"," + (margin.top) + ")")
    
var parseTime = d3.timeParse("%Y-%m-%d");
var pathToCsv = "boardgame_ratings.csv";
var x_scale = d3.scaleTime()
    .range([0, width]);

var y_scale = d3.scaleLinear()
    .range([height, 0]);

var y_scale3 = d3.scaleSqrt()
    .range([height, 0]);

var y_scale4 = d3.scaleLog()
    .range([height, 0]);

var colour = d3.schemeCategory10;

  data = d3.dsv(',', pathToCsv, function(d) {
     return { 
     date: parseTime(d.date),
     a: +d["Catan=count"],
     b: +d["Dominion=count"],
     c: +d["Codenames=count"],
     d: +d["Terraforming Mars=count"],
     e: +d["Gloomhaven=count"],
     f: +d["Magic: The Gathering=count"],
     g: +d["Dixit=count"],
     h: +d["Monopoly=count"],
     i: +d["Catan=rank"],
     j: +d["Codenames=rank"],
     k: +d["Terraforming Mars=rank"],
     l: +d["Gloomhaven=rank"]
     }
}).then(function (data) { 
    //console.log(data);
    x_scale.domain(d3.extent(data, function(d) { return d.date; }));
    y_scale.domain([0, d3.max(data, function(d) { return d3.max([d.a, d.b, d.c, d.d,d.e, d.f, d.g, d.h]); })])

    
    y_scale3.domain([0, d3.max(data, function(d) { return d3.max([d.a, d.b, d.c, d.d,d.e, d.f, d.g, d.h]); })])
    
    y_scale4.domain([1e-6, d3.max(data, function(d) { return d3.max([d.a, d.b, d.c, d.d,d.e, d.f, d.g, d.h]); })])       
    

    var list = ['a','b','c','d','e','f','g','h','a1','b1','c1','d1','e1','f1','g1','h1']
    var name = ["Catan","Dominion","Codenames","Terraforming Mars","Gloomhaven","Magic: The Gathering","Dixit","Monopoly"]
    //for (k=0; k<list.length; k++){
    data.forEach(function(d,i){
    if(i<8) {    
    
    //console.log(d[list[i]])
    var valueline = d3.line()
        .x(function(d) { return x_scale(d.date); })
        .y(function(d) { return y_scale(d[list[i]]); });
    
    var valueline3 = d3.line()
        .x(function(d) { return x_scale(d.date); })
        .y(function(d) { return y_scale3(d[list[i]]); });
    
    var valueline4 = d3.line()
        .x(function(d) { return x_scale(d.date); })
        .y(function(d) { return y_scale4(d[list[i]]); });
    
     la.append("path")
      //.attr("id", "lines-a")  //change
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", colour[i])
      .attr("stroke-linejoin", "round")
      .attr("stroke-linecap", "round")
      .attr("stroke-width", 1.5)
      .attr("d", valueline(data)); 
    
     la.append("text")     //change
		//.attr("id", "lines-a") 
        .attr("transform", "translate(" + (width+8) + "," + (y_scale(data[data.length-1][list[i]])) + ")")
		.attr("dy", ".35em")
		.attr("text-anchor", "start")
		.style("fill", colour[i])
		.text(name[i]);
    
     la2.append("path")
      //.attr("id", "lines-a")  //change
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", colour[i])
      .attr("stroke-linejoin", "round")
      .attr("stroke-linecap", "round")
      .attr("stroke-width", 1.5)
      .attr("d", valueline(data)); 
    
     la2.append("text")     //change
		//.attr("id", "lines-a") 
        .attr("transform", "translate(" + (width+8) + "," + (y_scale(data[data.length-1][list[i]])) + ")")
		.attr("dy", ".35em")
		.attr("text-anchor", "start")
		.style("fill", colour[i])
		.text(name[i]);



     
      la3.append("path")
      //.attr("id", "lines-a")  //change
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", colour[i])
      .attr("stroke-linejoin", "round")
      .attr("stroke-linecap", "round")
      .attr("stroke-width", 1.5)
      .attr("d", valueline3(data)); 
    
     la3.append("text")     //change
		//.attr("id", "lines-a") 
        .attr("transform", "translate(" + (width+8) + "," + (y_scale3(data[data.length-1][list[i]])) + ")")
		.attr("dy", ".35em")
		.attr("text-anchor", "start")
		.style("fill", colour[i])
		.text(name[i]);
    
    
      la4.append("path")
      //.attr("id", "lines-a")  //change
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", colour[i])
      .attr("stroke-linejoin", "round")
      .attr("stroke-linecap", "round")
      .attr("stroke-width", 1.5)
      .attr("d", valueline4(data)); 
    
     la4.append("text")     //change
		//.attr("id", "lines-a") 
        .attr("transform", "translate(" + (width+8) + "," + (y_scale4(data[data.length-1][list[i]])) + ")")
		.attr("dy", ".35em")
		.attr("text-anchor", "start")
		.style("fill", colour[i])
		.text(name[i]);

    

    
    }
    if(i==0 || i ==2 || i==3 || i==4){

     symb2.selectAll(".dot")
    .data(data.filter(function(d,i) { return (i+1)%3 == 0 && i>0}))
    .enter().append("circle") // Uses the enter().append() method
    //.attr("class", "dot1") // Assign a class for styling
    .attr("cx", function(d) { return x_scale(d.date) })
    .attr("cy", function(d) { return y_scale(d[list[i]]) })
    .attr("r", 11) 
    .style("fill", colour[i]) 
     
         symb3.selectAll(".dot")
    .data(data.filter(function(d,i) { return (i+1)%3 == 0 && i>0}))
    .enter().append("circle") // Uses the enter().append() method
    //.attr("class", "dot1") // Assign a class for styling
    .attr("cx", function(d) { return x_scale(d.date) })
    .attr("cy", function(d) { return y_scale3(d[list[i]]) })
    .attr("r", 11) 
    .style("fill", colour[i]) 
     
              symb4.selectAll(".dot")
    .data(data.filter(function(d,i) { return (i+1)%3 == 0 && i>0}))
    .enter().append("circle") // Uses the enter().append() method
    //.attr("class", "dot1") // Assign a class for styling
    .attr("cx", function(d) { return x_scale(d.date) })
    .attr("cy", function(d) { return y_scale4(d[list[i]]) })
    .attr("r", 11) 
    .style("fill", colour[i]) 
     
     
     data1 = d3.dsv(',', pathToCsv, function(c) {
     return { 
     date: parseTime(c.date),
     a1: +c["Catan=count"],
     // b: +d["Dominion=count"],
     c1: +c["Codenames=count"],
     d1: +c["Terraforming Mars=count"],
     e1: +c["Gloomhaven=count"],
     // f: +d["Magic: The Gathering=count"],
     // g: +d["Dixit=count"],
     // h: +d["Monopoly=count"],
     a: +c["Catan=rank"],
     c: +c["Codenames=rank"],
     d: +c["Terraforming Mars=rank"],
     e: +c["Gloomhaven=rank"]
     }
     }).then(function (data1) { 
     //console.log(list[i+8]);
     data1.filter(function(d,j) { return (j+1)%3 == 0 && j>0}).forEach(function(c,j){
        //console.log(c)
        symb2.append("text")
	    .data(data1.filter(function(d,j) { return (j+1)%3 == 0 && j>0}))
        //.data(data1.filter(function(d,j) { return (j+1)%3 == 0 && j>0}))
        .attr("dx", x_scale(c.date))
        .attr("dy", y_scale(c[list[i+8]])+2 )
        .attr("text-anchor", "middle")
        .style("fill", "white")
        .style("font-size", "10px") 
        .text(c[list[i]])
     
           symb3.append("text")
	    .data(data1.filter(function(d,j) { return (j+1)%3 == 0 && j>0}))
        //.data(data1.filter(function(d,j) { return (j+1)%3 == 0 && j>0}))
        .attr("dx", x_scale(c.date))
        .attr("dy", y_scale3(c[list[i+8]])+2 )
        .attr("text-anchor", "middle")
        .style("fill", "white")
        .style("font-size", "10px") 
        .text(c[list[i]])
     
                symb4.append("text")
	    .data(data1.filter(function(d,j) { return (j+1)%3 == 0 && j>0}))
        //.data(data1.filter(function(d,j) { return (j+1)%3 == 0 && j>0}))
        .attr("dx", x_scale(c.date))
        .attr("dy", y_scale4(c[list[i+8]])+2 )
        .attr("text-anchor", "middle")
        .style("fill", "white")
        .style("font-size", "10px") 
        .text(c[list[i]])
     
     
    
     })    })
     

    }
     
     
    })
    
    

   var x_axis = d3.axisBottom()
        .ticks(d3.timeMonth.every(3))
        .tickFormat(d3.timeFormat('%b %y'))
        .scale(x_scale);
          
    xaxis.call(x_axis);
    
    yaxis.call(d3.axisLeft(y_scale));
    // Add the X Axis
    xaxis.append("text")
     //.attr("class", "x label")
     .attr("text-anchor", "middle")
     .attr("fill","black")
     .attr("x", width/2)
     .attr("y", margin.top)         
     .text("Month");
    

    // Add the Y Axis
   
    //.attr("class", "y axis")
   
       
     yaxis
     .append("text")
       // .attr("id", "x-axis-a")     
        .attr("text-anchor", "middle")
        .attr("x", -width/6 )
        .attr("y", -margin.left+10)
        .attr("dy", "0.75em")
        .attr("transform", "rotate(-90)")
        .text("Num of Ratings");
    

    xaxis2.call(x_axis);
    
      xaxis2
      .append("text")
     //.attr("class", "x label")
     .attr("text-anchor", "middle")
     .attr("x", width/2)
     .attr("y", height+margin.top)         
     .text("Month");

    // Add the Y Axis
    yaxis2.call(d3.axisLeft(y_scale));
    //.attr("class", "y axis")
   
       
     yaxis2
     .append("text")
       // .attr("id", "x-axis-a")     
        .attr("text-anchor", "middle")
        .attr("x", -width/4 )
        .attr("y", -margin.left+10)
        .attr("dy", "0.75em")
        .attr("transform", "rotate(-90)")
        .text("Num of Ratings");
    
    xaxis3.call(x_axis);
    
      xaxis3
      .append("text")
     //.attr("class", "x label")
     .attr("text-anchor", "middle")
     .attr("x", width/2)
     .attr("y", height+margin.top)         
     .text("Month");

    // Add the Y Axis
    yaxis3.call(d3.axisLeft(y_scale3))
    //.attr("class", "y axis")
   
       
     yaxis3
     .append("text")
       // .attr("id", "x-axis-a")     
        .attr("text-anchor", "middle")
        .attr("x", -width/4 )
        .attr("y", -margin.left+10)
        .attr("dy", "0.75em")
        .attr("transform", "rotate(-90)")
        .text("Num of Ratings");
    
    xaxis4.call(x_axis);
    
      xaxis4
      .append("text")
     //.attr("class", "x label")
     .attr("text-anchor", "middle")
     .attr("x", width/2)
     .attr("y", height+margin.top)         
     .text("Month");

    // Add the Y Axis
    yaxis4.call(d3.axisLeft(y_scale4));
    //.attr("class", "y axis")
   
       
     yaxis4
     .append("text")
       // .attr("id", "x-axis-a")     
        .attr("text-anchor", "middle")
        .attr("x", 0 )
        .attr("y", 0)
        .attr("dy", "0.75em")
        .attr("transform", "rotate(-90)")
        .text("Num of Ratings");
    
    legend2.append("circle")
        .attr("cx",width+(margin.right/2)+5 )
        .attr("cy", height - (margin.bottom/2))
        .attr("r", 18);
        legend2.append("text")
        .attr("dx",width+(margin.right/2)+5 )
        .attr("dy", height - (margin.bottom/2)+2)
        .attr("text-anchor","middle")
        .attr("fill","white")
        .text("rank");
        legend2.append("text")
        .attr("dx",width+(margin.right/2)+5 )
        .attr("dy", height +10)
        .attr("text-anchor","middle")
        .text("BoardGameGeek Rank");
        
        
           legend3.append("circle")
        .attr("cx",width+(margin.right/2)+5 )
        .attr("cy", height - (margin.bottom/2))
        .attr("r", 18);
        legend3.append("text")
        .attr("dx",width+(margin.right/2)+5 )
        .attr("dy", height - (margin.bottom/2)+2)
        .attr("text-anchor","middle")
        .attr("fill","white")
        .text("rank");
        legend3.append("text")
        .attr("dx",width+(margin.right/2)+5 )
        .attr("dy", height +10)
        .attr("text-anchor","middle")
        .text("BoardGameGeek Rank");
        
        legend4.append("circle")
        .attr("cx",width+(margin.right/2)+5 )
        .attr("cy", height - (margin.bottom/2))
        .attr("r", 18);
        legend4.append("text")
        .attr("dx",width+(margin.right/2)+5 )
        .attr("dy", height - (margin.bottom/2)+2)
        .attr("text-anchor","middle")
        .attr("fill","white")
        .text("rank");
        legend4.append("text")
        .attr("dx",width+(margin.right/2)+5 )
        .attr("dy", height +10)
        .attr("text-anchor","middle")
        .text("BoardGameGeek Rank");
 
 }).catch(function (error) {
      console.log(error);
    });




</script>
</body>
</html>